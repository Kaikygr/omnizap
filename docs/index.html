<!DOCTYPE html>
<html lang="en">

<head>
  
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title> Home</title>

  <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="./build/entry.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,400,700|Inconsolata,700" rel="stylesheet">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
  <link type="text/css" rel="stylesheet" href="https://jmblog.github.io/color-themes-for-google-code-prettify/themes/tomorrow-night.min.css">
  <link type="text/css" rel="stylesheet" href="styles/app.min.css">
  <link type="text/css" rel="stylesheet" href="styles/iframe.css">
  <link type="text/css" rel="stylesheet" href="">
  <script async defer src="https://buttons.github.io/buttons.js"></script>

  
</head>



<body class="layout small-header">
    <div id="stickyNavbarOverlay"></div>
    

<div class="top-nav">
    <div class="inner">
        <a id="hamburger" role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
        </a>
        <div class="logo">
            
            
        </div>
        <div class="menu">
            
            <div class="navigation">
                <a
                    href="index.html"
                    class="link"
                >
                    Documentation
                </a>
                
                
                
            </div>
        </div>
    </div>
</div>
    <div id="main">
        <div
            class="sidebar "
            id="sidebarNav"
        >
            
            <nav>
                
                    <h2><a href="index.html">Documentation</a></h2><div class="category"><h3>Classes</h3><ul><li><a href="ConnectionManager.html">ConnectionManager</a></li><li><a href="MySQLDBManager.html">MySQLDBManager</a></li></ul><h3>Global</h3><ul><li><a href="global.html#_extractTextFromMessageObject">_extractTextFromMessageObject</a></li><li><a href="global.html#closePool">closePool</a></li><li><a href="global.html#connectConecta-seaoWhatsAppusandooestadodeautentica%25C3%25A7%25C3%25A3ocarregado.ConfiguraosocketBaileyscomasop%25C3%25A7%25C3%25B5esnecess%25C3%25A1rias,incluindologgereinforma%25C3%25A7%25C3%25B5esdonavegador.">connect
Conecta-se ao WhatsApp usando o estado de autentica√ß√£o carregado.
Configura o socket Baileys com as op√ß√µes necess√°rias, incluindo logger e informa√ß√µes do navegador.</a></li><li><a href="global.html#deleteChatData">deleteChatData</a></li><li><a href="global.html#deleteChatsDataBatch">deleteChatsDataBatch</a></li><li><a href="global.html#executeQuery">executeQuery</a></li><li><a href="global.html#getEventEmitter">getEventEmitter</a></li><li><a href="global.html#getInstance">getInstance</a></li><li><a href="global.html#handleBlocklistSetProcessaoeventodedefini%25C3%25A7%25C3%25A3odalistadebloqueio.Registraosn%25C3%25BAmerosqueest%25C3%25A3onalistadebloqueiodoWhatsApp.Esteevento%25C3%25A9disparadoquandoalistadebloqueio%25C3%25A9definidaousincronizada(evento'blocklist.set').">handleBlocklistSet
Processa o evento de defini√ß√£o da lista de bloqueio.
Registra os n√∫meros que est√£o na lista de bloqueio do WhatsApp.
Este evento √© disparado quando a lista de bloqueio √© definida ou sincronizada (evento 'blocklist.set').</a></li><li><a href="global.html#handleBlocklistUpdateProcessaatualiza%25C3%25A7%25C3%25B5esnalistadebloqueiodoWhatsApp.Registraaltera%25C3%25A7%25C3%25B5es(adi%25C3%25A7%25C3%25B5es/remo%25C3%25A7%25C3%25B5es)nalistadecontatosbloqueados.Esteevento%25C3%25A9disparadoquandoumJID%25C3%25A9adicionadoouremovidodalistadebloqueio(evento'blocklist.update').">handleBlocklistUpdate
Processa atualiza√ß√µes na lista de bloqueio do WhatsApp.
Registra altera√ß√µes (adi√ß√µes/remo√ß√µes) na lista de contatos bloqueados.
Este evento √© disparado quando um JID √© adicionado ou removido da lista de bloqueio (evento 'blocklist.update').</a></li><li><a href="global.html#handleCallProcessaeventosdechamadasrecebidasourealizadas.Registrainforma%25C3%25A7%25C3%25B5essobrechamadasdevoz/v%25C3%25ADdeonoWhatsApp.Esteevento%25C3%25A9disparadoparav%25C3%25A1riosest%25C3%25A1giosdeumachamada(oferta,aceita%25C3%25A7%25C3%25A3o,rejei%25C3%25A7%25C3%25A3o,t%25C3%25A9rmino)(evento'call').">handleCall
Processa eventos de chamadas recebidas ou realizadas.
Registra informa√ß√µes sobre chamadas de voz/v√≠deo no WhatsApp.
Este evento √© disparado para v√°rios est√°gios de uma chamada (oferta, aceita√ß√£o, rejei√ß√£o, t√©rmino) (evento 'call').</a></li><li><a href="global.html#handleChatsDeleteManipulaexclus%25C3%25A3odechats.Esteevento%25C3%25A9disparadoquandochatss%25C3%25A3odeletados(evento'chats.delete').">handleChatsDelete
Manipula exclus√£o de chats.
Este evento √© disparado quando chats s√£o deletados (evento 'chats.delete').</a></li><li><a href="global.html#handleChatsUpdateManipulaatualiza%25C3%25A7%25C3%25B5esdechats.Esteevento%25C3%25A9disparadoquandopropriedadesdeumchatexistentes%25C3%25A3oalteradas(ex:%2560unreadCount%2560,%2560mute%2560)(evento'chats.update').">handleChatsUpdate
Manipula atualiza√ß√µes de chats.
Este evento √© disparado quando propriedades de um chat existente s√£o alteradas (ex: `unreadCount`, `mute`) (evento 'chats.update').</a></li><li><a href="global.html#handleChatsUpsertManipulainser%25C3%25A7%25C3%25A3o/atualiza%25C3%25A7%25C3%25A3odechats.Esteevento%25C3%25A9disparadoquandonovoschatss%25C3%25A3ocriadosouchatsexistentess%25C3%25A3osincronizados(evento'chats.upsert').">handleChatsUpsert
Manipula inser√ß√£o/atualiza√ß√£o de chats.
Este evento √© disparado quando novos chats s√£o criados ou chats existentes s√£o sincronizados (evento 'chats.upsert').</a></li><li><a href="global.html#handleConnectionUpdateManipulaatualiza%25C3%25A7%25C3%25B5esdeconex%25C3%25A3odoclienteWhatsApp.Estem%25C3%25A9todo%25C3%25A9chamadoquandooestadodaconex%25C3%25A3ocomoWhatsAppmuda(evento%2560connection.update%2560).">handleConnectionUpdate
Manipula atualiza√ß√µes de conex√£o do cliente WhatsApp.
Este m√©todo √© chamado quando o estado da conex√£o com o WhatsApp muda (evento `connection.update`).</a></li><li><a href="global.html#handleContactsUpdateManipulaaatualiza%25C3%25A7%25C3%25A3odecontatos.(L%25C3%25B3gicadecacheRedisfoiremovida).Esteevento%25C3%25A9disparadoquandopropriedadesdeumcontatoexistentes%25C3%25A3oalteradas(ex:nome,notifica%25C3%25A7%25C3%25A3opush)(evento'contacts.update').">handleContactsUpdate
Manipula a atualiza√ß√£o de contatos.
(L√≥gica de cache Redis foi removida).
Este evento √© disparado quando propriedades de um contato existente s√£o alteradas (ex: nome, notifica√ß√£o push) (evento 'contacts.update').</a></li><li><a href="global.html#handleContactsUpsertManipulainser%25C3%25A7%25C3%25A3o/atualiza%25C3%25A7%25C3%25A3odecontatos.Esteevento%25C3%25A9disparadoquandonovoscontatoss%25C3%25A3oadicionadosoucontatosexistentess%25C3%25A3osincronizados(evento'contacts.upsert').">handleContactsUpsert
Manipula inser√ß√£o/atualiza√ß√£o de contatos.
Este evento √© disparado quando novos contatos s√£o adicionados ou contatos existentes s√£o sincronizados (evento 'contacts.upsert').</a></li><li><a href="global.html#handleCredsUpdateManipulaaatualiza%25C3%25A7%25C3%25A3odecredenciais.Estem%25C3%25A9todo%25C3%25A9chamadoporBaileysquandoascredenciaisdeautentica%25C3%25A7%25C3%25A3os%25C3%25A3oatualizadas(porexemplo,ap%25C3%25B3sescanearoQRcodeouduranteareconex%25C3%25A3o).Salvaasnovascredenciaisusando%2560this.auth.saveCreds()%2560.">handleCredsUpdate
Manipula a atualiza√ß√£o de credenciais.
Este m√©todo √© chamado por Baileys quando as credenciais de autentica√ß√£o s√£o atualizadas (por exemplo, ap√≥s escanear o QR code ou durante a reconex√£o).
Salva as novas credenciais usando `this.auth.saveCreds()`.</a></li><li><a href="global.html#handleGroupParticipantsUpdateManipulaatualiza%25C3%25A7%25C3%25B5esdeparticipantesdegrupos.Chamadoquandoparticipantesentram,saem,s%25C3%25A3opromovidosourebaixadosemumgrupo(evento'group-participants.update').">handleGroupParticipantsUpdate
Manipula atualiza√ß√µes de participantes de grupos.
Chamado quando participantes entram, saem, s√£o promovidos ou rebaixados em um grupo (evento 'group-participants.update').</a></li><li><a href="global.html#handleGroupsUpdateManipulaatualiza%25C3%25A7%25C3%25B5esdegrupos.Estem%25C3%25A9todo%25C3%25A9chamadoquandoh%25C3%25A1atualiza%25C3%25A7%25C3%25B5esnosmetadadosdegruposexistentes(ex:mudan%25C3%25A7adenome,descri%25C3%25A7%25C3%25A3o)(evento'groups.update').">handleGroupsUpdate
Manipula atualiza√ß√µes de grupos.
Este m√©todo √© chamado quando h√° atualiza√ß√µes nos metadados de grupos existentes (ex: mudan√ßa de nome, descri√ß√£o) (evento 'groups.update').</a></li><li><a href="global.html#handleGroupsUpsertManipulaainser%25C3%25A7%25C3%25A3o/atualiza%25C3%25A7%25C3%25A3odegrupos(quandoousu%25C3%25A1rioentraemumnovogrupoousincroniza%25C3%25A7%25C3%25A3oinicial).">handleGroupsUpsert
Manipula a inser√ß√£o/atualiza√ß√£o de grupos (quando o usu√°rio entra em um novo grupo ou sincroniza√ß√£o inicial).</a></li><li><a href="global.html#handleIrrecoverableDisconnectManipuladesconex%25C3%25A3oirrecuper%25C3%25A1vel(ex:logoutoum%25C3%25A1ximodetentativasatingido).Registraumerroinformandoousu%25C3%25A1riosobreasitua%25C3%25A7%25C3%25A3oeanecessidadederemoverosdadosdeautentica%25C3%25A7%25C3%25A3oereiniciarparagerarumnovoQRcode.Resetaoestadodereconex%25C3%25A3o.">handleIrrecoverableDisconnect
Manipula desconex√£o irrecuper√°vel (ex: logout ou m√°ximo de tentativas atingido).
Registra um erro informando o usu√°rio sobre a situa√ß√£o e a necessidade de
remover os dados de autentica√ß√£o e reiniciar para gerar um novo QR code.
Reseta o estado de reconex√£o.</a></li><li><a href="global.html#handleMessageReceiptUpdateManipulaatualiza%25C3%25A7%25C3%25B5esderecibodemensagem.Esteevento%25C3%25A9disparadoquandoostatusdeentrega/leituradeumamensagem%25C3%25A9atualizado(ex:'delivered','read','played')(evento'message-receipt.update').">handleMessageReceiptUpdate
Manipula atualiza√ß√µes de recibo de mensagem.
Este evento √© disparado quando o status de entrega/leitura de uma mensagem √© atualizado
(ex: 'delivered', 'read', 'played') (evento 'message-receipt.update').</a></li><li><a href="global.html#handleMessageReceiptUpdate//OriginalmethodbeforebatchingforreferenceifneededManipulaatualiza%25C3%25A7%25C3%25B5esderecibodemensagem.Esteevento%25C3%25A9disparadoquandoostatusdeentrega/leituradeumamensagem%25C3%25A9atualizado(ex:'delivered','read','played')(evento'message-receipt.update').">handleMessageReceiptUpdate // Original method before batching for reference if needed
Manipula atualiza√ß√µes de recibo de mensagem.
Este evento √© disparado quando o status de entrega/leitura de uma mensagem √© atualizado
(ex: 'delivered', 'read', 'played') (evento 'message-receipt.update').</a></li><li><a href="global.html#handleMessagesDeleteManipulaexclus%25C3%25A3odemensagens.Esteevento%25C3%25A9disparadoquandomensagenss%25C3%25A3odeletadas(evento'messages.delete').">handleMessagesDelete
Manipula exclus√£o de mensagens.
Este evento √© disparado quando mensagens s√£o deletadas (evento 'messages.delete').</a></li><li><a href="global.html#handleMessagesReactionManipularea%25C3%25A7%25C3%25B5esamensagens.Esteevento%25C3%25A9disparadoquandoumarea%25C3%25A7%25C3%25A3o%25C3%25A9adicionadaouremovidadeumamensagem(evento'messages.reaction').">handleMessagesReaction
Manipula rea√ß√µes a mensagens.
Este evento √© disparado quando uma rea√ß√£o √© adicionada ou removida de uma mensagem (evento 'messages.reaction').</a></li><li><a href="global.html#handleMessagesUpdateManipulaatualiza%25C3%25A7%25C3%25B5esdemensagens.Esteevento%25C3%25A9disparadoparaatualiza%25C3%25A7%25C3%25B5esemmensagensexistentes(ex:statusdeentrega,edi%25C3%25A7%25C3%25A3o-sesuportado)(evento'messages.update').">handleMessagesUpdate
Manipula atualiza√ß√µes de mensagens.
Este evento √© disparado para atualiza√ß√µes em mensagens existentes (ex: status de entrega, edi√ß√£o - se suportado) (evento 'messages.update').</a></li><li><a href="global.html#handleMessagesUpsertManipulamensagensnovas/atualizadas.Estem%25C3%25A9todo%25C3%25A9chamadoquandonovasmensagenss%25C3%25A3orecebidasoumensagensexistentess%25C3%25A3oatualizadas(evento'messages.upsert').">handleMessagesUpsert
Manipula mensagens novas/atualizadas.
Este m√©todo √© chamado quando novas mensagens s√£o recebidas ou mensagens existentes s√£o atualizadas (evento 'messages.upsert').</a></li><li><a href="global.html#handleMessagingHistorySetManipulaoeventodeconjuntodehist%25C3%25B3ricodemensagens.Esteevento%25C3%25A9disparadoduranteasincroniza%25C3%25A7%25C3%25A3oinicialdohist%25C3%25B3rico(evento'messaging-history.set'),fornecendoumconjuntodechats,contatosemensagens.">handleMessagingHistorySet
Manipula o evento de conjunto de hist√≥rico de mensagens.
Este evento √© disparado durante a sincroniza√ß√£o inicial do hist√≥rico (evento 'messaging-history.set'),
fornecendo um conjunto de chats, contatos e mensagens.</a></li><li><a href="global.html#handlePresenceUpdateProcessaatualiza%25C3%25A7%25C3%25B5esdepresen%25C3%25A7adoscontatos.Registraemonitoraaltera%25C3%25A7%25C3%25B5esnostatusdepresen%25C3%25A7a(online,offline,digitando,gravando%25C3%25A1udio)e%25C3%25BAltimavisualiza%25C3%25A7%25C3%25A3o(evento'presence.update').">handlePresenceUpdate
Processa atualiza√ß√µes de presen√ßa dos contatos.
Registra e monitora altera√ß√µes no status de presen√ßa (online, offline, digitando, gravando √°udio) e √∫ltima visualiza√ß√£o (evento 'presence.update').</a></li><li><a href="global.html#initialize">initialize</a></li><li><a href="global.html#initializeInicializaaconex%25C3%25A3oprincipalcomoWhatsApp.Estem%25C3%25A9todoorquestraocarregamentodoestadodeautentica%25C3%25A7%25C3%25A3oe,emseguida,tentaestabeleceraconex%25C3%25A3ocomoWhatsApp.">initialize
Inicializa a conex√£o principal com o WhatsApp.
Este m√©todo orquestra o carregamento do estado de autentica√ß√£o e, em seguida,
tenta estabelecer a conex√£o com o WhatsApp.</a></li><li><a href="global.html#loadAuthStateCarregaoestadodeautentica%25C3%25A7%25C3%25A3ododiret%25C3%25B3rioespecificadoem%2560this.authStatePath%2560.Seodiret%25C3%25B3rion%25C3%25A3oexistir,eleser%25C3%25A1criado.Utiliza%2560useMultiFileAuthState%2560dabibliotecaBaileysparagerenciarascredenciais.">loadAuthState
Carrega o estado de autentica√ß√£o do diret√≥rio especificado em `this.authStatePath`.
Se o diret√≥rio n√£o existir, ele ser√° criado.
Utiliza `useMultiFileAuthState` da biblioteca Baileys para gerenciar as credenciais.</a></li><li><a href="global.html#reconnectWithBackoffReconectaaoWhatsAppcombackoffexponencial.Incrementaocontadordetentativasdereconex%25C3%25A3oecalculaopr%25C3%25B3ximoatrasodeformaexponencial,limitadopelo%2560maxBackoffDelayMs%2560.Agendaumanovatentativadeconex%25C3%25A3o(%2560this.connect()%2560)ap%25C3%25B3soatrasocalculado.Seareconex%25C3%25A3ofalhar,eaindaforpermitidotentarnovamente,chamaasimesmorecursivamente.Casocontr%25C3%25A1rio,tratacomodesconex%25C3%25A3oirrecuper%25C3%25A1vel.">reconnectWithBackoff
Reconecta ao WhatsApp com backoff exponencial.
Incrementa o contador de tentativas de reconex√£o e calcula o pr√≥ximo atraso
de forma exponencial, limitado pelo `maxBackoffDelayMs`.
Agenda uma nova tentativa de conex√£o (`this.connect()`) ap√≥s o atraso calculado.
Se a reconex√£o falhar, e ainda for permitido tentar novamente, chama a si mesmo recursivamente. Caso contr√°rio, trata como desconex√£o irrecuper√°vel.</a></li><li><a href="global.html#resetReconnectionStateResetaoestadodereconex%25C3%25A3o.Define%2560this.reconnectionAttempts%2560para0,%2560this.currentBackoffDelayMs%2560para%2560this.initialBackoffDelayMs%2560,e%2560this.isReconnecting%2560para%2560false%2560.">resetReconnectionState
Reseta o estado de reconex√£o.
Define `this.reconnectionAttempts` para 0, `this.currentBackoffDelayMs` para `this.initialBackoffDelayMs`,
e `this.isReconnecting` para `false`.</a></li><li><a href="global.html#setupEventHandlersConfiguraosmanipuladoresdeeventosparaoclienteWhatsApp(Baileys).Registralistenersparaumavariedadedeeventos,comoatualiza%25C3%25A7%25C3%25B5esdeconex%25C3%25A3o,recebimentodemensagens,atualiza%25C3%25A7%25C3%25B5esdegrupos,chats,contatos,etc.Cadaevento%25C3%25A9vinculadoaom%25C3%25A9todocorrespondentenestaclasse.">setupEventHandlers
Configura os manipuladores de eventos para o cliente WhatsApp (Baileys).
Registra listeners para uma variedade de eventos, como atualiza√ß√µes de conex√£o,
recebimento de mensagens, atualiza√ß√µes de grupos, chats, contatos, etc.
Cada evento √© vinculado ao m√©todo correspondente nesta classe.</a></li><li><a href="global.html#shouldReconnectDeterminaseareconex%25C3%25A3odevesertentadacombasenomotivodadesconex%25C3%25A3o.">shouldReconnect
Determina se a reconex√£o deve ser tentada com base no motivo da desconex√£o.</a></li><li><a href="global.html#start">start</a></li><li><a href="global.html#updateGroupParticipants">updateGroupParticipants</a></li><li><a href="global.html#upsertChat">upsertChat</a></li><li><a href="global.html#upsertChatsBatch">upsertChatsBatch</a></li><li><a href="global.html#upsertGroup">upsertGroup</a></li><li><a href="global.html#upsertGroupsBatch">upsertGroupsBatch</a></li><li><a href="global.html#upsertMessage">upsertMessage</a></li><li><a href="global.html#upsertMessageReceipt">upsertMessageReceipt</a></li><li><a href="global.html#upsertMessageReceiptsBatch">upsertMessageReceiptsBatch</a></li><li><a href="global.html#upsertMessagesBatch">upsertMessagesBatch</a></li></ul></div>
                
            </nav>
        </div>
        <div class="core" id="main-content-wrapper">
            <div class="content">
                <header class="page-title">
                    <p></p>
                    <h1>Home</h1>
                </header>
                



    


    <h3> </h3>










    




    <section>
        <article><p><a href="https://freeimage.host/i/3DG6WBV"><img src="https://iili.io/3DG6WBV.md.png" alt="3DG6WBV.md.png"></a></p>
<h1>OmniZap</h1>
<p>Bot multifuncional para WhatsApp, desenvolvido em JavaScript como um projeto open-source e educacional.</p>
<h2>üìã Sobre</h2>
<p>OmniZap √© um bot vers√°til para WhatsApp que atende tanto usu√°rios pessoais quanto administradores de grupos e pequenas automa√ß√µes empresariais. Desenvolvido com foco em aprendizado e colabora√ß√£o da comunidade, com suporte a persist√™ncia de dados e cache.</p>
<h2>‚öôÔ∏è Funcionalidades Principais</h2>
<ul>
<li>Sistema robusto de gerenciamento de conex√£o com reconex√£o autom√°tica</li>
<li>Persist√™ncia completa de dados em MySQL</li>
<li>Sistema de cache com Redis para melhor performance</li>
<li>Gerenciamento avan√ßado de grupos</li>
<li>Tratamento de mensagens, recibos e eventos</li>
<li>Sistema de logs detalhado</li>
<li>Arquitetura modular e expans√≠vel</li>
</ul>
<h2>üèóÔ∏è Arquitetura</h2>
<p>O projeto √© composto por tr√™s componentes principais:</p>
<h3>ConnectionManager</h3>
<ul>
<li>Gerencia a conex√£o WebSocket com o WhatsApp</li>
<li>Implementa reconex√£o autom√°tica com backoff exponencial</li>
<li>Gerencia eventos do WhatsApp (mensagens, grupos, contatos)</li>
<li>Integra com Redis para cache e MySQL para persist√™ncia</li>
</ul>
<h3>MySQLDBManager</h3>
<ul>
<li>Gerencia todas as opera√ß√µes com o banco de dados MySQL</li>
<li>Implementa padr√£o Singleton para conex√£o</li>
<li>Gerencia pool de conex√µes para melhor performance</li>
<li>Fornece m√©todos CRUD para todas as entidades:
<ul>
<li>Chats</li>
<li>Grupos e Participantes</li>
<li>Mensagens e Recibos</li>
<li>Contatos</li>
</ul>
</li>
</ul>
<h3>Sistema de Cache (Redis)</h3>
<ul>
<li>Cache de metadados com TTL configur√°vel</li>
<li>Prefixos espec√≠ficos para cada tipo de dado:
<ul>
<li><code>chat:</code> - Dados de conversas</li>
<li><code>group:</code> - Metadados de grupos</li>
<li><code>contact:</code> - Informa√ß√µes de contatos</li>
<li><code>message:</code> - Mensagens e recibos</li>
</ul>
</li>
</ul>
<h2>üóÑÔ∏è Estrutura do Banco de Dados</h2>
<h3>Tabelas MySQL</h3>
<h4>Chats</h4>
<pre class="prettyprint source lang-sql"><code>CREATE TABLE Chats (
    jid VARCHAR(255) PRIMARY KEY,
    name VARCHAR(255),
    unread_count INT DEFAULT 0,
    last_message_timestamp BIGINT,
    is_group BOOLEAN DEFAULT 0,
    pinned_timestamp BIGINT DEFAULT 0,
    mute_until_timestamp BIGINT DEFAULT 0,
    archived BOOLEAN DEFAULT 0,
    ephemeral_duration INT,
    created_at BIGINT,
    updated_at BIGINT
);
</code></pre>
<h4>Groups</h4>
<pre class="prettyprint source lang-sql"><code>CREATE TABLE Groups (
    jid VARCHAR(255) PRIMARY KEY,
    subject VARCHAR(255),
    owner_jid VARCHAR(255),
    creation_timestamp BIGINT,
    description TEXT,
    restrict_mode BOOLEAN DEFAULT 0,
    announce_mode BOOLEAN DEFAULT 0,
    img_url TEXT,
    created_at BIGINT,
    updated_at BIGINT,
    FOREIGN KEY (jid) REFERENCES Chats(jid) ON DELETE CASCADE
);
</code></pre>
<h4>GroupParticipants</h4>
<pre class="prettyprint source lang-sql"><code>CREATE TABLE GroupParticipants (
    group_jid VARCHAR(255) NOT NULL,
    participant_jid VARCHAR(255) NOT NULL,
    admin_status VARCHAR(50),
    PRIMARY KEY (group_jid, participant_jid),
    FOREIGN KEY (group_jid) REFERENCES Groups(jid) ON DELETE CASCADE
);
</code></pre>
<h4>Messages</h4>
<pre class="prettyprint source lang-sql"><code>CREATE TABLE Messages (
    message_id VARCHAR(255) NOT NULL,
    chat_jid VARCHAR(255) NOT NULL,
    sender_jid VARCHAR(255),
    from_me BOOLEAN NOT NULL,
    message_timestamp BIGINT NOT NULL,
    push_name VARCHAR(255),
    message_type VARCHAR(50),
    quoted_message_id VARCHAR(255),
    quoted_message_sender_jid VARCHAR(255),
    raw_message_content JSON,
    created_at BIGINT,
    updated_at BIGINT,
    PRIMARY KEY (message_id, chat_jid),
    INDEX idx_messages_chat_timestamp (chat_jid, message_timestamp),
    INDEX idx_messages_sender (sender_jid),
    FOREIGN KEY (chat_jid) REFERENCES Chats(jid) ON DELETE CASCADE
);
</code></pre>
<h4>MessageReceipts</h4>
<pre class="prettyprint source lang-sql"><code>CREATE TABLE MessageReceipts (
    message_id VARCHAR(255) NOT NULL,
    chat_jid VARCHAR(255) NOT NULL,
    recipient_jid VARCHAR(255) NOT NULL,
    receipt_type VARCHAR(50) NOT NULL,
    receipt_timestamp BIGINT NOT NULL,
    PRIMARY KEY (message_id, chat_jid, recipient_jid, receipt_type),
    FOREIGN KEY (message_id, chat_jid) REFERENCES Messages(message_id, chat_jid) ON DELETE CASCADE
);
</code></pre>
<h2>‚ö° Cache Redis</h2>
<h3>TTLs Configurados</h3>
<ul>
<li><code>REDIS_TTL_METADATA_SHORT</code>: 3600s (1 hora) - Metadados de curta dura√ß√£o</li>
<li><code>REDIS_TTL_METADATA_LONG</code>: 86400s (24 horas) - Metadados de longa dura√ß√£o</li>
<li><code>REDIS_TTL_MESSAGE</code>: 604800s (7 dias) - Mensagens</li>
<li><code>REDIS_TTL_RECEIPT</code>: 604800s (7 dias) - Recibos</li>
</ul>
<h3>Prefixos de Cache</h3>
<ul>
<li><code>chat:</code> - Dados de conversas</li>
<li><code>group:</code> - Metadados de grupos</li>
<li><code>contact:</code> - Informa√ß√µes de contatos</li>
<li><code>message:</code> - Mensagens e recibos</li>
</ul>
<h2>üîÑ Sistema de Cache</h2>
<h3>Diagrama de Rela√ß√µes</h3>
<pre class="prettyprint source lang-ascii"><code>‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Cache Redis ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                                                            ‚îÇ
‚îÇ  Prefixos e TTLs:                                          ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê               ‚îÇ
‚îÇ  ‚îÇ REDIS_PREFIX_GROUP    (TTL: 1h)         ‚îÇ               ‚îÇ
‚îÇ  ‚îÇ REDIS_PREFIX_CHAT     (TTL: 1h)         ‚îÇ               ‚îÇ
‚îÇ  ‚îÇ REDIS_PREFIX_CONTACT  (TTL: 24h)        ‚îÇ               ‚îÇ
‚îÇ  ‚îÇ REDIS_PREFIX_MESSAGE  (TTL: 7d)         ‚îÇ               ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò               ‚îÇ
‚îÇ                                                            ‚îÇ
‚îÇ  Estrutura de Dados:                                       ‚îÇ
‚îÇ                                                            ‚îÇ
‚îÇ    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Mensagem ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                       ‚îÇ
‚îÇ    ‚îÇ Key: message:&lt;remoteJid>:&lt;id> ‚îÇ                       ‚îÇ
‚îÇ    ‚îÇ - messageContentType          ‚îÇ    ‚îå‚îÄ‚îÄ Grupo ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ    ‚îÇ - receipts                    ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫  Key: group:&lt;jid>‚îÇ
‚îÇ    ‚îÇ - groupMetadata (se grupo)    ‚îÇ    ‚îÇ - participantes  ‚îÇ
‚îÇ    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ - descri√ß√£o      ‚îÇ
‚îÇ                ‚îÇ                        ‚îÇ - configura√ß√µes  ‚îÇ
‚îÇ                ‚îÇ                        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                ‚îÇ                                           ‚îÇ
‚îÇ                ‚îÇ         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Chat ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê               ‚îÇ
‚îÇ                ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ Key: chat:&lt;id>  ‚îÇ               ‚îÇ
‚îÇ                          ‚îÇ - unreadCount   ‚îÇ               ‚îÇ
‚îÇ                          ‚îÇ - lastMessage   ‚îÇ               ‚îÇ
‚îÇ                          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚îÄ‚îÄ‚îò               ‚îÇ
‚îÇ                                ‚îÇ                           ‚îÇ
‚îÇ                                ‚îÇ                           ‚îÇ
‚îÇ                     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ Contato ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                    ‚îÇ
‚îÇ                     ‚îÇ Key:contact:&lt;id>‚îÇ                    ‚îÇ
‚îÇ                     ‚îÇ - nome          ‚îÇ                    ‚îÇ
‚îÇ                     ‚îÇ - notify        ‚îÇ                    ‚îÇ
‚îÇ                     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚îò                    ‚îÇ
‚îÇ                                                            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚îÄ‚îò
</code></pre>
<h2>üéØ Sistema de Eventos</h2>
<h3>Eventos Principais</h3>
<h4>Conex√£o</h4>
<ul>
<li><code>connection.update</code> - Atualiza√ß√µes de estado da conex√£o</li>
<li><code>creds.update</code> - Atualiza√ß√µes de credenciais</li>
</ul>
<h4>Mensagens</h4>
<ul>
<li><code>messages.upsert</code> - Novas mensagens/atualiza√ß√µes</li>
<li><code>messages.update</code> - Atualiza√ß√µes de status</li>
<li><code>messages.delete</code> - Exclus√£o de mensagens</li>
<li><code>messages.reaction</code> - Rea√ß√µes em mensagens</li>
<li><code>message-receipt.update</code> - Recibos de mensagem</li>
</ul>
<h4>Grupos</h4>
<ul>
<li><code>groups.update</code> - Atualiza√ß√µes de metadados</li>
<li><code>groups.upsert</code> - Novos grupos</li>
<li><code>group-participants.update</code> - Mudan√ßas de participantes</li>
</ul>
<h4>Chats e Contatos</h4>
<ul>
<li><code>chats.upsert</code> - Novos chats</li>
<li><code>chats.update</code> - Atualiza√ß√µes de chat</li>
<li><code>chats.delete</code> - Exclus√£o de chats</li>
<li><code>contacts.upsert</code> - Novos contatos</li>
<li><code>contacts.update</code> - Atualiza√ß√µes de contato</li>
</ul>
<h4>Outros</h4>
<ul>
<li><code>blocklist.set</code> - Lista de bloqueio</li>
<li><code>blocklist.update</code> - Atualiza√ß√µes de bloqueio</li>
<li><code>call</code> - Chamadas de voz/v√≠deo</li>
<li><code>presence.update</code> - Status de presen√ßa</li>
</ul>
<h3>Fluxo de Dados</h3>
<ol>
<li>Evento recebido do WhatsApp</li>
<li>Processamento pelo handler espec√≠fico</li>
<li>Atualiza√ß√£o do cache Redis (se aplic√°vel)</li>
<li>Persist√™ncia no MySQL (se aplic√°vel)</li>
<li>Emiss√£o de eventos customizados para subscribers</li>
</ol>
<h3>Estrutura de Chaves</h3>
<h4>Mensagens</h4>
<ul>
<li><strong>Chave</strong>: <code>message:&lt;remoteJid&gt;:&lt;id&gt;</code></li>
<li><strong>TTL</strong>: 7 dias</li>
<li><strong>Dados</strong>:
<ul>
<li>Conte√∫do da mensagem</li>
<li>Tipo de conte√∫do</li>
<li>Status de entrega/leitura</li>
<li>Metadados do grupo (se aplic√°vel)</li>
</ul>
</li>
</ul>
<h4>Grupos</h4>
<ul>
<li><strong>Chave</strong>: <code>group:&lt;jid&gt;</code></li>
<li><strong>TTL</strong>: 1 hora</li>
<li><strong>Dados</strong>:
<ul>
<li>Lista de participantes</li>
<li>Configura√ß√µes do grupo</li>
<li>Descri√ß√£o</li>
<li>Imagem do grupo</li>
</ul>
</li>
</ul>
<h4>Chats</h4>
<ul>
<li><strong>Chave</strong>: <code>chat:&lt;id&gt;</code></li>
<li><strong>TTL</strong>: 1 hora</li>
<li><strong>Dados</strong>:
<ul>
<li>Contagem de mensagens n√£o lidas</li>
<li>√öltima mensagem</li>
<li>Status de silenciamento</li>
<li>Configura√ß√µes do chat</li>
</ul>
</li>
</ul>
<h4>Contatos</h4>
<ul>
<li><strong>Chave</strong>: <code>contact:&lt;id&gt;</code></li>
<li><strong>TTL</strong>: 24 horas</li>
<li><strong>Dados</strong>:
<ul>
<li>Nome do contato</li>
<li>Configura√ß√µes de notifica√ß√£o</li>
<li>Informa√ß√µes de perfil</li>
</ul>
</li>
</ul>
<h3>Estrat√©gia de Cache</h3>
<ol>
<li>
<p><strong>Cache First</strong></p>
<ul>
<li>Todas as consultas primeiro verificam o cache</li>
<li>Em caso de miss, busca da API e atualiza o cache</li>
</ul>
</li>
<li>
<p><strong>TTLs Diferenciados</strong></p>
<ul>
<li>Metadados de curta dura√ß√£o: 1 hora</li>
<li>Informa√ß√µes de contato: 24 horas</li>
<li>Mensagens e recibos: 7 dias</li>
</ul>
</li>
<li>
<p><strong>Invalida√ß√£o Autom√°tica</strong></p>
<ul>
<li>TTLs autom√°ticos para evitar dados obsoletos</li>
<li>Atualiza√ß√£o proativa em eventos relevantes</li>
</ul>
</li>
<li>
<p><strong>Otimiza√ß√£o de Desempenho</strong></p>
<ul>
<li>Cache de metadados de grupo para opera√ß√µes frequentes</li>
<li>Armazenamento de recibos de mensagem para consulta r√°pida</li>
</ul>
</li>
<li>
<p><strong>Persist√™ncia em Camadas</strong></p>
<ul>
<li>Redis: Dados frequentemente acessados</li>
<li>MySQL: Armazenamento persistente de longo prazo</li>
<li>Sincroniza√ß√£o autom√°tica entre camadas</li>
</ul>
</li>
</ol>
<h3>Monitoramento e Logs</h3>
<ul>
<li>Rastreamento de hits/misses do cache</li>
<li>Logging detalhado de opera√ß√µes</li>
<li>M√©tricas de performance por tipo de dado</li>
<li>Alertas para falhas de cache</li>
</ul>
<h2>üöÄ Come√ßando</h2>
<h3>Pr√©-requisitos</h3>
<ul>
<li>Node.js v14+</li>
<li>NPM ou Yarn</li>
<li>MySQL Server 8.0+</li>
<li>Redis Server 6.0+</li>
</ul>
<h3>Configura√ß√£o do Ambiente</h3>
<p>Configure as vari√°veis de ambiente em um arquivo <code>.env</code>:</p>
<pre class="prettyprint source lang-env"><code># MySQL
MYSQL_HOST=localhost
MYSQL_PORT=3306
MYSQL_USER=seu_usuario
MYSQL_PASSWORD=sua_senha
MYSQL_DATABASE_NAME=omnizap_db

# Redis
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# Reconex√£o
BACKOFF_INITIAL_DELAY_MS=5000
BACKOFF_MAX_DELAY_MS=60000

# Auth State
AUTH_STATE_PATH=./auth_state
</code></pre>
<h3>Instala√ß√£o</h3>
<pre class="prettyprint source lang-bash"><code># Clone o reposit√≥rio
git clone https://github.com/Kaikygr/OmniZap.git

# Entre no diret√≥rio
cd OmniZap

# Instale as depend√™ncias
npm install

# Inicie o bot
npm start
</code></pre>
<h2>üõ†Ô∏è Tecnologias</h2>
<ul>
<li>JavaScript/Node.js</li>
<li><a href="https://github.com/WhiskeySockets/Baileys">Baileys</a> - Framework WhatsApp Web API</li>
<li>MySQL - Sistema de Banco de Dados</li>
<li>Redis - Sistema de Cache</li>
<li>Winston - Sistema de Logs</li>
<li>Envalid - Valida√ß√£o de vari√°veis de ambiente</li>
<li>ioredis - Cliente Redis</li>
<li>mysql2 - Cliente MySQL</li>
</ul>
<h2>üìÑ Licen√ßa</h2>
<p>Este projeto est√° sob a licen√ßa MIT - veja o arquivo <a href="LICENSE">LICENSE</a> para detalhes.</p>
<h2>ü§ù Contribuindo</h2>
<p>Contribui√ß√µes s√£o bem-vindas! Por favor, leia nosso guia de contribui√ß√£o antes de submeter pull requests.</p>
<h2>üí∞ Apoie o Projeto</h2>
<p>Se voc√™ gostou do projeto e quer apoiar seu desenvolvimento: <a href="https://bit.ly/m/Kaally">Apoiar</a></p>
<hr>
<p>üöÄ <strong>OmniZap</strong> ‚Äî Sistema robusto e escal√°vel para automa√ß√£o do WhatsApp</p>
<p>‚ö†Ô∏è <strong>Aviso</strong>: Este √© um projeto educacional e n√£o se destina a fins comerciais ou spam.</p></article>
    </section>






            </div>
            
            <footer class="footer">
                <div class="content has-text-centered">
                    <p>Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.4</a></p>
                    <p class="sidebar-created-by">
                        <a href="https://github.com/SoftwareBrothers/better-docs" target="_blank">BetterDocs theme</a> provided with <i class="fas fa-heart"></i> by
                        <a href="http://softwarebrothers.co" target="_blank">SoftwareBrothers - JavaScript Development Agency</a>
                    </p>
                </div>
            </footer>
            
        </div>
        <div id="side-nav" class="side-nav">
        </div>
    </div>
<script src="scripts/app.min.js"></script>
<script>PR.prettyPrint();</script>
<script src="scripts/linenumber.js"> </script>


</body>
</html>