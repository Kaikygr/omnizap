<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>JSDoc: Class: ConnectionManager</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css" />
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css" />
  </head>

  <body>
    <div id="main">
      <h1 class="page-title">Class: ConnectionManager</h1>

      <section>
        <header>
          <h2>
            <span class="attribs"><span class="type-signature"></span></span>ConnectionManager<span class="signature">()</span><span class="type-signature"></span>
          </h2>
        </header>

        <article>
          <div class="container-overview">
            <h4 class="name" id="ConnectionManager"><span class="type-signature"></span>new ConnectionManager<span class="signature">()</span><span class="type-signature"></span></h4>

            <div class="description">Gerencia a conexão com a API do WhatsApp Web, utilizando a biblioteca Baileys. É responsável por estabelecer e manter a conexão, lidar com a autenticação, gerenciar eventos de mensagens, grupos, contatos, e sincronizar esses dados com um cache Redis e um banco de dados MySQL. Implementa uma lógica de reconexão com backoff exponencial para lidar com desconexões temporárias.</div>

            <h5 class="subsection-title">Properties:</h5>

            <table class="props">
              <thead>
                <tr>
                  <th>Name</th>

                  <th>Type</th>

                  <th class="last">Description</th>
                </tr>
              </thead>

              <tbody>
                <tr>
                  <td class="name"><code>client</code></td>

                  <td class="type">
                    <span class="param-type">WASocket</span>
                    |

                    <span class="param-type">null</span>
                  </td>

                  <td class="description last">A instância do cliente Baileys (socket) para interagir com o WhatsApp. Inicializado como `null` e populado após a conexão bem-sucedida.</td>
                </tr>

                <tr>
                  <td class="name"><code>redisClient</code></td>

                  <td class="type">
                    <span class="param-type">RedisClient</span>
                  </td>

                  <td class="description last">Cliente para interagir com o servidor Redis, utilizado para cache de metadados, mensagens, chats e contatos.</td>
                </tr>

                <tr>
                  <td class="name"><code>mysqlDbManager</code></td>

                  <td class="type">
                    <span class="param-type">Object</span>
                  </td>

                  <td class="description last">Instância do gerenciador do banco de dados MySQL, responsável pela persistência dos dados.</td>
                </tr>

                <tr>
                  <td class="name"><code>auth</code></td>

                  <td class="type">
                    <span class="param-type">AuthObject</span>
                  </td>

                  <td class="description last">Objeto contendo o estado de autenticação (`state`) e o método `saveCreds` fornecido por `useMultiFileAuthState` para gerenciar as credenciais de login.</td>
                </tr>

                <tr>
                  <td class="name"><code>authStatePath</code></td>

                  <td class="type">
                    <span class="param-type">string</span>
                  </td>

                  <td class="description last">Caminho no sistema de arquivos onde os dados de autenticação são armazenados.</td>
                </tr>

                <tr>
                  <td class="name"><code>initialBackoffDelayMs</code></td>

                  <td class="type">
                    <span class="param-type">number</span>
                  </td>

                  <td class="description last">Tempo de espera inicial (em milissegundos) antes da primeira tentativa de reconexão.</td>
                </tr>

                <tr>
                  <td class="name"><code>maxBackoffDelayMs</code></td>

                  <td class="type">
                    <span class="param-type">number</span>
                  </td>

                  <td class="description last">Tempo de espera máximo (em milissegundos) para reconexão. O tempo de espera aumenta exponencialmente a cada tentativa, até atingir este limite.</td>
                </tr>

                <tr>
                  <td class="name"><code>currentBackoffDelayMs</code></td>

                  <td class="type">
                    <span class="param-type">number</span>
                  </td>

                  <td class="description last">O tempo de espera atual (em milissegundos) para a próxima tentativa de reconexão.</td>
                </tr>

                <tr>
                  <td class="name"><code>reconnectionAttempts</code></td>

                  <td class="type">
                    <span class="param-type">number</span>
                  </td>

                  <td class="description last">Contador do número de tentativas de reconexão consecutivas.</td>
                </tr>

                <tr>
                  <td class="name"><code>maxReconnectionAttempts</code></td>

                  <td class="type">
                    <span class="param-type">number</span>
                  </td>

                  <td class="description last">Número máximo de tentativas de reconexão antes de considerar a desconexão como irrecuperável (ex: logout).</td>
                </tr>

                <tr>
                  <td class="name"><code>isReconnecting</code></td>

                  <td class="type">
                    <span class="param-type">boolean</span>
                  </td>

                  <td class="description last">Flag que indica se o ConnectionManager está atualmente tentando se reconectar.</td>
                </tr>
              </tbody>
            </table>

            <dl class="details">
              <dt class="tag-source">Source:</dt>
              <dd class="tag-source">
                <ul class="dummy">
                  <li><a href="connection_ConnectionManager.js.html">connection/ConnectionManager.js</a>, <a href="connection_ConnectionManager.js.html#line96">line 96</a></li>
                </ul>
              </dd>
            </dl>
          </div>
        </article>
      </section>

      <section>
        <header>
          <h2>
            <span class="attribs"><span class="type-signature"></span></span>ConnectionManager<span class="signature">(mysqlDbManager, initialBackoffDelayMs<span class="signature-attributes">opt</span>, maxBackoffDelayMs<span class="signature-attributes">opt</span>, authStatePath<span class="signature-attributes">opt</span>)</span><span class="type-signature"></span>
          </h2>
        </header>

        <article>
          <div class="container-overview">
            <h4 class="name" id="ConnectionManager">
              <span class="type-signature"></span>new ConnectionManager<span class="signature">(mysqlDbManager, initialBackoffDelayMs<span class="signature-attributes">opt</span>, maxBackoffDelayMs<span class="signature-attributes">opt</span>, authStatePath<span class="signature-attributes">opt</span>)</span><span class="type-signature"></span>
            </h4>

            <div class="description">Cria uma nova instância do `ConnectionManager`. Inicializa os parâmetros de configuração para a conexão, reconexão, e o cliente Redis.</div>

            <h5>Parameters:</h5>

            <table class="params">
              <thead>
                <tr>
                  <th>Name</th>

                  <th>Type</th>

                  <th>Attributes</th>

                  <th>Default</th>

                  <th class="last">Description</th>
                </tr>
              </thead>

              <tbody>
                <tr>
                  <td class="name"><code>mysqlDbManager</code></td>

                  <td class="type">
                    <span class="param-type">Object</span>
                  </td>

                  <td class="attributes"></td>

                  <td class="default"></td>

                  <td class="description last">A instância do gerenciador do banco de dados MySQL.</td>
                </tr>

                <tr>
                  <td class="name"><code>initialBackoffDelayMs</code></td>

                  <td class="type">
                    <span class="param-type">number</span>
                  </td>

                  <td class="attributes">&lt;optional><br /></td>

                  <td class="default">env.BACKOFF_INITIAL_DELAY_MS</td>

                  <td class="description last">Atraso inicial para reconexão em milissegundos.</td>
                </tr>

                <tr>
                  <td class="name"><code>maxBackoffDelayMs</code></td>

                  <td class="type">
                    <span class="param-type">number</span>
                  </td>

                  <td class="attributes">&lt;optional><br /></td>

                  <td class="default">env.BACKOFF_MAX_DELAY_MS</td>

                  <td class="description last">Atraso máximo para reconexão em milissegundos.</td>
                </tr>

                <tr>
                  <td class="name"><code>authStatePath</code></td>

                  <td class="type">
                    <span class="param-type">string</span>
                  </td>

                  <td class="attributes">&lt;optional><br /></td>

                  <td class="default">env.AUTH_STATE_PATH</td>

                  <td class="description last">Caminho para o diretório onde o estado de autenticação será salvo.</td>
                </tr>
              </tbody>
            </table>

            <dl class="details">
              <dt class="tag-source">Source:</dt>
              <dd class="tag-source">
                <ul class="dummy">
                  <li><a href="connection_ConnectionManager.js.html">connection/ConnectionManager.js</a>, <a href="connection_ConnectionManager.js.html#line139">line 139</a></li>
                </ul>
              </dd>
            </dl>
          </div>
        </article>
      </section>
    </div>

    <nav>
      <h2><a href="index.html">Home</a></h2>
      <h3>Classes</h3>
      <ul>
        <li><a href="ConnectionManager.html">ConnectionManager</a></li>
        <li><a href="MySQLDBManager.html">MySQLDBManager</a></li>
      </ul>
      <h3>Global</h3>
      <ul>
        <li><a href="global.html#DEFAULT_LOG_LEVEL">DEFAULT_LOG_LEVEL</a></li>
        <li><a href="global.html#ECOSYSTEM_NAME">ECOSYSTEM_NAME</a></li>
        <li><a href="global.html#INSTANCE_ID">INSTANCE_ID</a></li>
        <li><a href="global.html#IS_PRODUCTION">IS_PRODUCTION</a></li>
        <li><a href="global.html#LOG_COLORS">LOG_COLORS</a></li>
        <li><a href="global.html#LOG_DEFAULTS">LOG_DEFAULTS</a></li>
        <li><a href="global.html#LOG_DIR_PATH">LOG_DIR_PATH</a></li>
        <li><a href="global.html#LOG_LEVELS">LOG_LEVELS</a></li>
        <li><a href="global.html#LOG_LEVEL_NAMES">LOG_LEVEL_NAMES</a></li>
        <li><a href="global.html#NODE_ENV">NODE_ENV</a></li>
        <li><a href="global.html#PROJECT_ROOT">PROJECT_ROOT</a></li>
        <li><a href="global.html#REDIS_PREFIX_CHAT">REDIS_PREFIX_CHAT</a></li>
        <li><a href="global.html#REDIS_PREFIX_CONTACT">REDIS_PREFIX_CONTACT</a></li>
        <li><a href="global.html#REDIS_PREFIX_GROUP">REDIS_PREFIX_GROUP</a></li>
        <li><a href="global.html#REDIS_PREFIX_MESSAGE">REDIS_PREFIX_MESSAGE</a></li>
        <li><a href="global.html#REDIS_TTL_MESSAGE">REDIS_TTL_MESSAGE</a></li>
        <li><a href="global.html#REDIS_TTL_METADATA_LONG">REDIS_TTL_METADATA_LONG</a></li>
        <li><a href="global.html#REDIS_TTL_METADATA_SHORT">REDIS_TTL_METADATA_SHORT</a></li>
        <li><a href="global.html#REDIS_TTL_RECEIPT">REDIS_TTL_RECEIPT</a></li>
        <li><a href="global.html#closePool">closePool</a></li>
        <li><a href="global.html#consoleFormat">consoleFormat</a></li>
        <li><a href="global.html#createLoggerInstance">createLoggerInstance</a></li>
        <li><a href="global.html#deleteChatData">deleteChatData</a></li>
        <li><a href="global.html#env">env</a></li>
        <li><a href="global.html#executeQuery">executeQuery</a></li>
        <li><a href="global.html#fileFormat">fileFormat</a></li>
        <li><a href="global.html#getDefaultTransportDefinitions">getDefaultTransportDefinitions</a></li>
        <li><a href="global.html#getInstance">getInstance</a></li>
        <li><a href="global.html#initialize">initialize</a></li>
        <li><a href="global.html#logger">logger</a></li>
        <li><a href="global.html#start">start</a></li>
        <li><a href="global.html#syncFromRedis">syncFromRedis</a></li>
        <li><a href="global.html#updateGroupParticipants">updateGroupParticipants</a></li>
        <li><a href="global.html#upsertChat">upsertChat</a></li>
        <li><a href="global.html#upsertGroup">upsertGroup</a></li>
        <li><a href="global.html#upsertMessage">upsertMessage</a></li>
        <li><a href="global.html#upsertMessageReceipt">upsertMessageReceipt</a></li>
      </ul>
    </nav>

    <br class="clear" />

    <footer>Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Sun May 25 2025 14:40:27 GMT-0400 (Horário Padrão do Amazonas)</footer>

    <script>
      prettyPrint();
    </script>
    <script src="scripts/linenumber.js"></script>
  </body>
</html>
